{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Messages=()=>{const[conversations,setConversations]=useState([]);const[selectedConversation,setSelectedConversation]=useState(null);const[messages,setMessages]=useState([]);const[newMessage,setNewMessage]=useState('');const[loading,setLoading]=useState(true);useEffect(()=>{fetchConversations();},[]);useEffect(()=>{if(selectedConversation){fetchMessages();}},[selectedConversation]);const fetchConversations=async()=>{try{const response=await axios.get('http://localhost:8080/api/messages/conversations');setConversations(response.data);setLoading(false);}catch(error){console.error('Error fetching conversations:',error);setLoading(false);}};const fetchMessages=async()=>{try{const response=await axios.get(`http://localhost:8080/api/messages/project/${selectedConversation.projectId}`);setMessages(response.data);}catch(error){console.error('Error fetching messages:',error);}};const handleSendMessage=async e=>{e.preventDefault();if(!newMessage.trim())return;try{await axios.post('http://localhost:8080/api/messages',{projectId:selectedConversation.projectId,content:newMessage});setNewMessage('');fetchMessages();}catch(error){console.error('Error sending message:',error);}};if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-64\",children:\"Loading...\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-6xl mx-auto p-6\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900 mb-6\",children:\"Messages\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-lg h-[600px] flex\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-1/3 border-r\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-4 border-b\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold\",children:\"Conversations\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-y-auto h-[calc(100%-60px)]\",children:conversations.map(conversation=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>setSelectedConversation(conversation),className:`p-4 border-b cursor-pointer hover:bg-gray-50 ${(selectedConversation===null||selectedConversation===void 0?void 0:selectedConversation.projectId)===conversation.projectId?'bg-blue-50':''}`,children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold\",children:conversation.projectTitle}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:conversation.otherUserName}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:new Date(conversation.lastMessageAt).toLocaleString()})]},conversation.projectId))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 flex flex-col\",children:selectedConversation?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 border-b\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold\",children:selectedConversation.projectTitle}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"Chat with \",selectedConversation.otherUserName]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 overflow-y-auto p-4\",children:messages.map(message=>/*#__PURE__*/_jsx(\"div\",{className:`mb-4 ${message.senderId===selectedConversation.currentUserId?'text-right':'text-left'}`,children:/*#__PURE__*/_jsxs(\"div\",{className:`inline-block max-w-xs px-4 py-2 rounded-lg ${message.senderId===selectedConversation.currentUserId?'bg-blue-600 text-white':'bg-gray-200 text-gray-800'}`,children:[/*#__PURE__*/_jsx(\"p\",{children:message.content}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs opacity-75 mt-1\",children:new Date(message.createdAt).toLocaleTimeString()})]})},message.id))}),/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSendMessage,className:\"p-4 border-t\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newMessage,onChange:e=>setNewMessage(e.target.value),placeholder:\"Type a message...\",className:\"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700\",children:\"Send\"})]})})]}):/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 flex items-center justify-center text-gray-500\",children:\"Select a conversation to start messaging\"})})]})]});};export default Messages;","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Messages","conversations","setConversations","selectedConversation","setSelectedConversation","messages","setMessages","newMessage","setNewMessage","loading","setLoading","fetchConversations","fetchMessages","response","get","data","error","console","projectId","handleSendMessage","e","preventDefault","trim","post","content","className","children","map","conversation","onClick","projectTitle","otherUserName","Date","lastMessageAt","toLocaleString","message","senderId","currentUserId","createdAt","toLocaleTimeString","id","onSubmit","type","value","onChange","target","placeholder"],"sources":["E:/App Development/LanceHub/frontend/src/pages/Messages.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst Messages = () => {\r\n  const [conversations, setConversations] = useState([]);\r\n  const [selectedConversation, setSelectedConversation] = useState(null);\r\n  const [messages, setMessages] = useState([]);\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    fetchConversations();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (selectedConversation) {\r\n      fetchMessages();\r\n    }\r\n  }, [selectedConversation]);\r\n\r\n  const fetchConversations = async () => {\r\n    try {\r\n      const response = await axios.get('http://localhost:8080/api/messages/conversations');\r\n      setConversations(response.data);\r\n      setLoading(false);\r\n    } catch (error) {\r\n      console.error('Error fetching conversations:', error);\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchMessages = async () => {\r\n    try {\r\n      const response = await axios.get(\r\n        `http://localhost:8080/api/messages/project/${selectedConversation.projectId}`\r\n      );\r\n      setMessages(response.data);\r\n    } catch (error) {\r\n      console.error('Error fetching messages:', error);\r\n    }\r\n  };\r\n\r\n  const handleSendMessage = async (e) => {\r\n    e.preventDefault();\r\n    if (!newMessage.trim()) return;\r\n\r\n    try {\r\n      await axios.post('http://localhost:8080/api/messages', {\r\n        projectId: selectedConversation.projectId,\r\n        content: newMessage\r\n      });\r\n      setNewMessage('');\r\n      fetchMessages();\r\n    } catch (error) {\r\n      console.error('Error sending message:', error);\r\n    }\r\n  };\r\n\r\n  if (loading) return <div className=\"flex justify-center items-center h-64\">Loading...</div>;\r\n\r\n  return (\r\n    <div className=\"max-w-6xl mx-auto p-6\">\r\n      <h1 className=\"text-3xl font-bold text-gray-900 mb-6\">Messages</h1>\r\n      \r\n      <div className=\"bg-white rounded-lg shadow-lg h-[600px] flex\">\r\n        {/* Conversations List */}\r\n        <div className=\"w-1/3 border-r\">\r\n          <div className=\"p-4 border-b\">\r\n            <h2 className=\"text-lg font-semibold\">Conversations</h2>\r\n          </div>\r\n          <div className=\"overflow-y-auto h-[calc(100%-60px)]\">\r\n            {conversations.map((conversation) => (\r\n              <div\r\n                key={conversation.projectId}\r\n                onClick={() => setSelectedConversation(conversation)}\r\n                className={`p-4 border-b cursor-pointer hover:bg-gray-50 ${\r\n                  selectedConversation?.projectId === conversation.projectId ? 'bg-blue-50' : ''\r\n                }`}\r\n              >\r\n                <h3 className=\"font-semibold\">{conversation.projectTitle}</h3>\r\n                <p className=\"text-sm text-gray-600\">\r\n                  {conversation.otherUserName}\r\n                </p>\r\n                <p className=\"text-xs text-gray-500\">\r\n                  {new Date(conversation.lastMessageAt).toLocaleString()}\r\n                </p>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Messages Area */}\r\n        <div className=\"flex-1 flex flex-col\">\r\n          {selectedConversation ? (\r\n            <>\r\n              <div className=\"p-4 border-b\">\r\n                <h3 className=\"font-semibold\">{selectedConversation.projectTitle}</h3>\r\n                <p className=\"text-sm text-gray-600\">\r\n                  Chat with {selectedConversation.otherUserName}\r\n                </p>\r\n              </div>\r\n              \r\n              <div className=\"flex-1 overflow-y-auto p-4\">\r\n                {messages.map((message) => (\r\n                  <div\r\n                    key={message.id}\r\n                    className={`mb-4 ${\r\n                      message.senderId === selectedConversation.currentUserId ? 'text-right' : 'text-left'\r\n                    }`}\r\n                  >\r\n                    <div\r\n                      className={`inline-block max-w-xs px-4 py-2 rounded-lg ${\r\n                        message.senderId === selectedConversation.currentUserId\r\n                          ? 'bg-blue-600 text-white'\r\n                          : 'bg-gray-200 text-gray-800'\r\n                      }`}\r\n                    >\r\n                      <p>{message.content}</p>\r\n                      <p className=\"text-xs opacity-75 mt-1\">\r\n                        {new Date(message.createdAt).toLocaleTimeString()}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n\r\n              <form onSubmit={handleSendMessage} className=\"p-4 border-t\">\r\n                <div className=\"flex gap-2\">\r\n                  <input\r\n                    type=\"text\"\r\n                    value={newMessage}\r\n                    onChange={(e) => setNewMessage(e.target.value)}\r\n                    placeholder=\"Type a message...\"\r\n                    className=\"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                  />\r\n                  <button\r\n                    type=\"submit\"\r\n                    className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700\"\r\n                  >\r\n                    Send\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </>\r\n          ) : (\r\n            <div className=\"flex-1 flex items-center justify-center text-gray-500\">\r\n              Select a conversation to start messaging\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Messages;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}